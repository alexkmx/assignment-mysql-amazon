CREATE DATABASE JS09_MessagesBy_ALEJANDRO_JOEL;

CREATE TABLE Users(
	Id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	Username VARCHAR(50) NOT NULL,
	Password CHAR(41) NOT NULL,
);

CREATE TABLE Messages(
	Id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	Content TEXT NOT NULL,
	Created_At TIMESTAMP NOT NULL 	
	Id_Users INT,
	FOREIGN KEY (Id_Users) REFERENCES Users(Id)
);

INSERT INTO Users(Username, Password)
VALUES("tapeface",PASSWORD("tapeface"));

INSERT INTO Users(Username, Password)
VALUES("butterface",PASSWORD("butterface"));

INSERT INTO Messages(Id_Users, Content, Created_At)
VALUES(1,"How is it going my friend!?",20170910234512);

INSERT INTO Messages(Id_Users, Content, Created_At)
VALUES(1,"Are u there?",20170910235525);

INSERT INTO Messages(Id_Users, Content, Created_At)
VALUES(2,"Iâ€™m here! Really cool. How about you man? Tell me something.",20170911002033);


SELECT D.DEPARTMENT_NAME, COUNT(E.DEPARTMENT_ID) AS "Users by Dept."
FROM Departments D 
INNER JOIN Employees E 
ON D.DEPARTMENT_ID = E.DEPARTMENT_ID 
GROUP BY D.DEPARTMENT_ID;


SELECT E.EMPLOYEE_ID, J.JOB_TITLE, D.DEPARTMENT_ID, DATEDIFF(JH.END_DATE,JH.START_DATE)  FROM Employees E
INNER JOIN Jobs J
ON E.JOB_ID = J.JOB_ID
INNER JOIN Departments D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
INNER JOIN JobHistory JH
ON E.EMPLOYEE_ID = JH.EMPLOYEE_ID
WHERE D.DEPARTMENT_ID = 90 ;


SELECT D.DEPARTMENT_NAME, D.MANAGER_ID, E.FIRST_NAME, L.CITY FROM Departments D
INNER JOIN Employees E
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
INNER JOIN Locations L
ON D.LOCATION_ID = L.LOCATION_ID;


SELECT JOB_TITLE, AVG((MIN_SALARY + MAX_SALARY) / 2)
FROM Jobs GROUP BY JOB_TITLE
ORDER BY AVG((MIN_SALARY + MAX_SALARY) / 2) DESC;


SELECT E.FIRST_NAME, E.LAST_NAME, JH.START_DATE, JH.END_DATE, E.SALARY FROM Employees E
INNER JOIN JobHistory JH ON E.EMPLOYEE_ID = JH.EMPLOYEE_ID
WHERE SALARY > 10000
ORDER BY SALARY DESC;




